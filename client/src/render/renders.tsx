import { setLang, lang$, NClasses, getHomePage } from 'common/box';
import { useState } from 'react';
import useInterval from 'react-use/esm/useInterval';
import renderActions from './renderActions';
import RenderContent from './RenderContent';
import { RenderFactory, renderAdd, renderChildren, RenderDefault, RenderProps } from './RenderFactory';
import RenderPrice from './RenderPrice';
import useMessager from '~src/hooks/useMessager';
import setTitle from '~src/helpers/setTitle';
import app from '~src/app';
import router from '~src/helpers/router';
import { getSitePage } from '~src/site/sitePage';
import RenderCl from './RenderCl';

renderAdd('box', RenderDefault);
renderAdd('btn', RenderDefault);
renderAdd('row', RenderDefault);
renderAdd('column', RenderDefault);
renderAdd('center', RenderDefault);
renderAdd('ctn', RenderContent);

renderAdd('header', ({ b, a }: RenderProps) => (
  <div {...a}>
    <RenderContent b={b} p="title" />
    <RenderContent b={b} p="desc" />
    {renderChildren(b)}
  </div>
));

renderAdd('page', ({ b, a }) => {
  useMessager(router.updated$);
  const sitePage = getSitePage();
  if (sitePage !== b.n.page) return null;
  setTitle(b.n.pageTitle);
  return <div {...a}>{renderChildren(b)}</div>;
});

renderAdd('img', ({ b, a }) => {
  const imgUrl = b.n.img;
  return imgUrl ? <img {...a} src={imgUrl} alt={b.n.alt} /> : null;
});

// renderAdd('video', ({ n, attrs }) => {
//   const url = getVideoUrl(n.video);
//   console.debug('Video render', n);
//   return url ? (
//     <video autoPlay loop {...attrs}>
//       <source src={url} type="video/mp4"></source>
//       Your browser does not support the video tag.
//     </video>
//   ) : null;
// });

renderAdd('cat', ({ b, a }: RenderProps) => (
  <div {...a}>
    <div className="header">
      <RenderContent b={b} p="title" />
      <RenderContent b={b} p="tPrice" />
      <RenderContent b={b} p="tPrice2" />
      <RenderContent b={b} p="tPrice3" />
      <RenderPrice b={b} p="price" />
      <RenderContent b={b} p="desc" />
    </div>
    {renderChildren(b)}
  </div>
));

export const VegSvg = () => (
  <svg viewBox="0 0 24 24">
    <path d="M21.878.464l-2.486.557c-2.128.418-2.466.544-3.414 1.246-1.346 1.002-2.287 2.937-2.281 4.694.007.67.106 1.147.219 1.021a3 3 0 0 0 .199-.424c.404-.975 1.578-2.46 2.579-3.262.51-.411 1.538-.815 1.538-.603 0 .073-.351.51-.769.948-.391.418-.524.59-1.26 1.657-.762 1.121-1.757 3.123-2.426 4.906l-1.446 4.144-1.107 3.196c-.106.039-.397-.909-1.007-3.262-.948-3.686-1.353-4.953-2.321-7.26-.663-1.571-1.538-2.831-3.315-4.76-.974-1.068-2.36-2.089-3.195-2.367-.544-.186-.59-.093-.179.365C3.143 3.441 4.263 5.059 5.45 7.359c1.001 1.956 1.69 3.898 2.943 8.354l1.247 5.171.603 2.672a.39.39 0 0 0 .226.166 6.76 6.76 0 0 0 1.544 0c.345-.1.411-.372.889-3.501a36.28 36.28 0 0 1 1.133-5.271c.922-3.222 1.903-5.582 2.5-5.967.086-.053.51-.159.955-.232 1.723-.285 3.109-1.047 4.09-2.26.656-.809.829-1.406.995-3.395.086-1.054.139-1.352.338-1.982.126-.411.212-.783.199-.829-.047-.119-.153-.106-1.234.179z" />
  </svg>
);

export const BioSvg = () => (
  <svg viewBox="0 0 24 24">
    <path d="M24 0v24H0V0h24zM11.425 22.193l.014-13.389c-.028-1.616-2.024-2.013-4.273.129-1.105 1.053-2.583 2.323-4.361 5.853S.89 22.111.89 22.111l1.806-.027c.023-1.205.17-2.356.52-3.421H9.51l.055 3.53h1.86zm1.396-14.815l.055 14.815h4.022c1.834 0 4.31-.848 4.296-4.132-.011-2.736-2.469-3.739-2.853-3.739s1.567-.196 1.567-3.261-3.058-3.656-5.172-3.656c-1.395 0-1.915-.027-1.915-.027zm1.915 8.138s.69-.064 1.729-.064 2.923.694 2.923 2.445-1.204 2.572-2.38 2.572l-2.272.028v-4.981zM3.928 16.802l5.664.028V9.277c-2.659 2.331-4.828 4.774-5.664 7.525zm10.817-7.659h1.068c.848 0 2.33.387 2.371 2.23.047 2.085-1.44 2.542-2.165 2.542s-1.255-.013-1.255-.013l-.019-4.759zm.758-8.102s-1.033 1.81-.247 3.887c.75 1.982 3.041 2.976 5.148 2.439s2.761-2.742 2.761-2.742-1.09-.181-2.601.215c-1.149.301-2.38 1.756-2.38 1.756s.411-1.834-.383-3.284-2.298-2.271-2.298-2.271z" />
  </svg>
);

export const AocSvg = () => (
  <svg viewBox="0 0 24 24">
    <path d="m1.047 16.38c0.104-0.434 3.642-13.296 3.77-13.772 0.128-0.475 0.968-0.607 1.123-0.122 0.155 0.484 2.027 7.841 2.027 7.841s0.053-1.125 0.773-1.863c1.005-1.03 3.505-1.165 4.545-0.028 1.113 1.217 0.722 2.933 0.722 2.933s1.298-1.428 2.681-2.098c1.384-0.669 3.367-0.804 4.352-0.59s1.776 0.42 2.118 0.32c0.343-0.1 0.457-0.428 0.457-0.428l0.385 0.025-0.716 3.846-0.318-0.043s-0.101-0.961-0.46-1.74c-0.692-1.507-3.839-2.377-6.256 0.443-2.255 2.63-2.224 5.502-2.033 6.984 0.351 2.725 3.191 3.676 5.797 2.167 1.358-0.787 1.959-1.604 1.959-1.604l0.309 0.282s-2.033 3.096-5.747 2.875c-3.655-0.218-4.572-3.339-4.618-5.086-0.044-1.674 0.643-3.048 0.643-3.048s-0.8 0.371-2.174 0.24c-1.204-0.114-1.717-0.783-1.717-0.783s0.607 2.371 0.739 2.84c0.282 0.999-1.019 1.526-1.368 0.449-0.382-1.178-0.619-2.225-0.841-3.015-0.22-0.779-0.722-0.869-1.257-0.861-0.579 9e-3 -1.093-3e-3 -1.712-4e-3 -0.578 0-1.036 0.353-1.244 0.902-0.199 0.524-1.178 2.811-1.301 3.111-0.263 0.636-0.79 0.466-0.638-0.173zm-0.59 2.042-0.457 1.645s1.143-0.857 2.51-0.713c2.027 0.215 2.691 2.085 5.547 2.26 1.42 0.087 2.565-0.644 2.565-0.644l-0.312-1.306s-1.157 0.64-2.115 0.571c-2.54-0.183-3.048-2.128-5.593-2.233-1.438-0.059-2.145 0.42-2.145 0.42zm9.343-7.528c0.049 1.311 0.286 2.125 1.175 2.14 1.002 0.017 1.243-0.858 1.249-2.207 9e-3 -1.793-0.466-2.293-1.228-2.296-0.757-3e-3 -1.258 0.7-1.196 2.363zm-4.464-6.07s-1.306 5.696-1.408 6.069c-0.103 0.373 0.165 0.852 0.435 0.852 0.271 0 1.362-4e-3 1.705 0 0.344 4e-3 0.635-0.276 0.527-0.824-0.092-0.466-1.259-6.097-1.259-6.097z"/>
  </svg>
)

export const AopSvg = () => (
  <svg viewBox="0 0 24 24">
    <path fill="#ed1a3b" d="m12 .42.8 1.32L13.82.56l.6 1.43 1.17-1 .36 1.5 1.32-.81.12 1.54 1.43-.59-.12 1.54 1.5-.36-.36 1.5 1.54-.12-.6 1.43 1.55.12-.8 1.32 1.5.36-1 1.18 1.42.59-1.18 1 1.32.81-1.32.8 1.18 1.01-1.43.6 1 1.17-1.5.36.81 1.32-1.54.12.59 1.43-1.54-.12.36 1.5-1.5-.36.12 1.54-1.43-.6-.12 1.55-1.32-.8-.36 1.5-1.18-1-.59 1.42-1-1.18-.81 1.32-.8-1.32-1.01 1.18-.6-1.43-1.17 1-.36-1.5-1.32.81-.12-1.54-1.43.59.12-1.54-1.5.36.36-1.5-1.54.12.6-1.43-1.55-.12.8-1.32-1.5-.36 1-1.18-1.42-.59 1.18-1L.42 12l1.32-.8-1.18-1.01 1.43-.6-1-1.17 1.5-.36-.81-1.32 1.54-.12-.59-1.43 1.54.12-.36-1.5 1.5.36-.12-1.54 1.43.6.12-1.55 1.32.8.36-1.5 1.18 1 .59-1.42 1 1.18L12 .42Z"/>
    <circle cx="12" cy="12" r="10.08" fill="#ffde2d"/>
    <circle cx="12" cy="12" r="6.86" fill="#ed1a3b"/>
    <path fill="#ed1a3b" fill-rule="nonzero" d="M18.1 17.63a.25.25 0 0 1 0 .5.25.25 0 0 1 0-.5Zm-12.31-.12a.25.25 0 1 1 0 .5.25.25 0 0 1 0-.5Zm13.9-.72-.44-.29-.16.25a.38.38 0 0 0-.05.09c-.01.03-.01.05 0 .07 0 .02 0 .04.03.06l.06.06-.02.03-.39-.26.02-.03a1.54 1.54 0 0 0 .12.05h.04l.04-.02.04-.04a.42.42 0 0 0 .05-.05l.16-.25-.37-.24a.41.41 0 0 0-.1-.05h-.03l-.03.02-.02.04-.13.19a1.07 1.07 0 0 0-.08.14v.06a.48.48 0 0 0 .03.15l.05.11-.02.04-.21-.28.57-.86.03.02-.03.04-.02.03V16l.1.08.73.48c.07.05.12.07.14.07.04-.01.07-.04.1-.08l.03-.04.03.02-.57.86-.25-.17.02-.02.08.03.06.02.05-.01a.2.2 0 0 0 .04-.02.48.48 0 0 0 .1-.11l.2-.3Zm-14.8-.56.26.44.23-.03.12-.03.02-.02v-.08a.57.57 0 0 0-.03-.08l.03-.02.22.36-.04.02c-.03-.04-.06-.07-.08-.07l-.1-.01-.13.01-1.18.17-.02-.03.71-.97a.96.96 0 0 0 .07-.1.24.24 0 0 0 .03-.08v-.07a.32.32 0 0 0-.03-.06l.03-.02.28.45-.04.02a.3.3 0 0 0-.04-.05.1.1 0 0 0-.03-.03.06.06 0 0 0-.07 0 .17.17 0 0 0-.04.04l-.05.07-.12.17Zm-.05.06-.35.47.58-.08-.23-.4Zm15.5-.78-.48-.2-.11.26a.37.37 0 0 0-.03.1v.07l.05.05a.5.5 0 0 0 .08.05l-.02.03-.43-.18.02-.03a.95.95 0 0 0 .12.02.12.12 0 0 0 .08-.03.21.21 0 0 0 .03-.04.49.49 0 0 0 .03-.07l.12-.27-.4-.17a.43.43 0 0 0-.11-.03h-.04l-.02.03-.02.04-.09.21a.9.9 0 0 0-.05.16v.06l.02.05.05.09.07.1-.01.04-.27-.24.4-.95.04.02-.02.04-.01.04v.08l.03.03c.01.02.05.04.1.06l.8.34c.08.03.14.05.16.04.03-.01.06-.04.08-.1l.02-.04.04.02-.4.94-.28-.11.01-.02.1.01h.05a.1.1 0 0 0 .05-.02.2.2 0 0 0 .04-.02.49.49 0 0 0 .07-.13l.14-.33Zm-16.1-.12.36-.16c.07-.03.12-.06.13-.08v-.12l-.03-.05.04-.02.22.53-.03.01-.02-.04a.17.17 0 0 0-.04-.06.11.11 0 0 0-.06-.03c-.02 0-.07 0-.14.04l-.79.34a.44.44 0 0 0-.13.09c-.02.04-.01.08 0 .12l.03.05-.04.01-.2-.45a.85.85 0 0 1-.07-.27v-.1a.37.37 0 0 1 .1-.19.33.33 0 0 1 .1-.07.4.4 0 0 1 .15-.03c.05 0 .1 0 .14.02.04.02.08.05.12.1.04.03.07.08.1.14l.06.22Zm16.38.6-.14-.37.01-.03.21.2-.08.2Zm-16.43-.58a1.28 1.28 0 0 0-.05-.15.24.24 0 0 0-.14-.13.3.3 0 0 0-.22.01.35.35 0 0 0-.11.07.26.26 0 0 0-.08.2c0 .04 0 .08.02.11l.03.06.04.06.5-.23Zm-.32-1.16.37-.1c.09-.02.13-.04.15-.06.02-.03.02-.07.01-.12l-.01-.05.03-.01.15.55-.04.01-.01-.05a.18.18 0 0 0-.03-.06.1.1 0 0 0-.05-.04c-.03 0-.08 0-.15.02l-.83.21c-.08.02-.13.04-.15.07-.02.03-.02.07-.01.12l.01.05h-.03l-.13-.47a.84.84 0 0 1-.03-.28.38.38 0 0 1 .15-.27.34.34 0 0 1 .1-.05.4.4 0 0 1 .16-.01c.05 0 .1.02.13.05.04.02.08.06.1.1.04.05.06.1.08.17l.03.22Zm16.88.5-.42-.08v-.03c.12 0 .2-.03.27-.07.1-.06.16-.15.2-.27a.44.44 0 0 0-.1-.42.73.73 0 0 0-.36-.22.82.82 0 0 0-.36-.02l-.14.05a.52.52 0 0 0-.2.17.46.46 0 0 0-.06.13.54.54 0 0 0 0 .28l.37.1a.7.7 0 0 0 .08.02h.08l.03-.03a.26.26 0 0 0 .04-.1h.04l-.14.5h-.03v-.13a.15.15 0 0 0-.06-.04.52.52 0 0 0-.1-.03l-.39-.1a1.27 1.27 0 0 1-.03-.25.92.92 0 0 1 .04-.24c.07-.25.2-.42.4-.5a.65.65 0 0 1 .58.01.74.74 0 0 1 .4.54.72.72 0 0 1-.05.36l-.03.06a2.77 2.77 0 0 1-.13.2l.01.04.07.03-.01.04ZM3.8 14.26a.98.98 0 0 0-.02-.16.24.24 0 0 0-.12-.15.3.3 0 0 0-.1-.03l-.12.01a.37.37 0 0 0-.12.06.27.27 0 0 0-.1.3.6.6 0 0 0 .05.11l.53-.14Zm-.87-1.17.52-.03-.01-.3c0-.04 0-.07-.02-.1a.14.14 0 0 0-.03-.06.13.13 0 0 0-.07-.03h-.08v-.04l.46-.02v.03a.84.84 0 0 0-.12.04.11.11 0 0 0-.03.02l-.02.04-.02.05a.4.4 0 0 0 0 .07l.02.3.44-.02.1-.02h.02l.01-.03v-.29a1.48 1.48 0 0 0-.02-.16.24.24 0 0 0-.03-.05.44.44 0 0 0-.12-.1 1.13 1.13 0 0 0-.11-.06v-.04l.34.1.05 1.02h-.04v-.04a.17.17 0 0 0-.02-.08.12.12 0 0 0-.03-.03.07.07 0 0 0-.03-.02h-.13l-.86.04c-.09 0-.14.01-.16.03-.02.02-.04.06-.03.12v.05h-.04l-.05-1.03.3-.01v.02c-.04 0-.07.02-.1.03a.23.23 0 0 0-.05.02.12.12 0 0 0-.03.04.3.3 0 0 0-.02.04l-.01.14.02.36Zm18.1-.65-.53-.02-.01.29a.4.4 0 0 0 0 .1c0 .03.02.05.03.07l.06.03.09.02v.04l-.47-.03v-.03a1.65 1.65 0 0 0 .13-.03.11.11 0 0 0 .06-.06l.01-.04.01-.07.02-.3-.44-.02h-.11l-.02.01-.01.02-.01.03a.4.4 0 0 0 0 .04l-.02.23a1.08 1.08 0 0 0 0 .17l.03.05a.42.42 0 0 0 .1.11l.11.07v.04l-.33-.13.06-1.03h.03v.09l.01.04.02.03.03.02.13.02.87.05c.08 0 .13 0 .15-.02.03-.02.05-.06.05-.12v-.04h.04l-.05 1.03-.3-.02v-.02l.1-.02.05-.02.04-.03.03-.04a.44.44 0 0 0 .02-.14l.02-.37Zm.42.37-.26-.3v-.04l.27.12-.01.22ZM3.83 11l.01-.03.36.12-.02 1.03h-.03v-.05c0-.06-.02-.1-.06-.12-.02-.02-.07-.02-.14-.02l-.86-.02c-.09 0-.14 0-.16.02-.03.03-.04.07-.05.12v.05h-.03v-.6h.05v.08l.01.06.02.04.03.02a.4.4 0 0 0 .15.02l.84.02h.06a.2.2 0 0 0 .04-.01l.03-.02.02-.02v-.16l.01-.1c0-.1 0-.17-.02-.21a.27.27 0 0 0-.03-.06.27.27 0 0 0-.05-.05.46.46 0 0 0-.07-.06 1.32 1.32 0 0 0-.1-.05Zm17.26.82-.32.02v-.03c.04 0 .08-.01.1-.03a.22.22 0 0 0 .08-.05.19.19 0 0 0 .03-.07v-.29l-1.02.05c-.08 0-.13.02-.15.04-.03.02-.04.06-.04.11v.05h-.03l-.03-.56h.04v.04c0 .06.02.1.06.12.02.01.07.02.14.01l1.02-.05v-.16l-.02-.1a.18.18 0 0 0-.04-.08.19.19 0 0 0-.07-.05.46.46 0 0 0-.12-.02v-.04l.31-.01.06 1.1ZM4.07 9.72l.02-.03.33.18-.18 1.02H4.2l.01-.06c.01-.05 0-.1-.03-.13l-.14-.04-.85-.16h-.16c-.03.02-.05.06-.06.1l-.01.06-.04-.01.11-.6.04.01-.01.1v.05c0 .02 0 .03.02.04l.02.03c.02.01.07.03.15.04l.82.15h.13l.02-.03.04-.14.02-.1a.7.7 0 0 0 .01-.22.23.23 0 0 0-.06-.12 1.22 1.22 0 0 0-.16-.13Zm16.81 0a.6.6 0 0 1-.1.49.67.67 0 0 1-.45.28.7.7 0 0 1-.53-.09.62.62 0 0 1-.29-.41.62.62 0 0 1 .1-.5.7.7 0 0 1 .46-.28c.2-.04.4 0 .55.11.14.1.23.24.26.4Zm-.07 0a.36.36 0 0 0-.23-.27.58.58 0 0 0-.2-.04 1.07 1.07 0 0 0-.5.1.64.64 0 0 0-.19.12.4.4 0 0 0-.1.16.34.34 0 0 0-.01.18.3.3 0 0 0 .07.16c.03.05.08.09.13.12.06.03.13.04.2.05.09 0 .18 0 .28-.02.1-.02.19-.05.26-.08a.63.63 0 0 0 .19-.12.4.4 0 0 0 .1-.16.39.39 0 0 0 0-.2Zm-16.42-1-.2.48.16.16.1.07.03.01.03-.01.03-.04a.48.48 0 0 0 .04-.07l.04.02-.16.38h-.03V9.6a.28.28 0 0 0-.05-.08 1.14 1.14 0 0 0-.08-.1l-.84-.85.01-.03 1.2-.01a1 1 0 0 0 .13 0l.08-.03a.14.14 0 0 0 .05-.04.27.27 0 0 0 .03-.06l.04.01-.2.5-.04-.02.02-.07v-.04c0-.01 0-.02-.02-.03l-.02-.02a.21.21 0 0 0-.06-.01H4.4Zm14.98.62-.15-.32.37-.68-.02-.04a.77.77 0 0 1-.01-.03l-.01-.03-.01-.02-.36.16c-.07.04-.12.07-.13.1-.01.03 0 .07.01.11l.02.05-.03.01-.24-.51.03-.02.02.05c.03.05.06.08.1.08.03 0 .08 0 .14-.04l.79-.36c.07-.04.12-.07.13-.1.01-.03 0-.07-.01-.12l-.03-.04.04-.02.2.44c.06.13.1.23.1.3v.1a.34.34 0 0 1-.17.25.3.3 0 0 1-.23.02.36.36 0 0 1-.11-.06.6.6 0 0 1-.11-.11l-.23.4a.7.7 0 0 0-.1.23l.03.18-.03.02ZM4.31 8.72h-.58l.4.42.18-.42Zm15.28-.53.01.03.01.02c.03.06.06.1.1.14.03.04.06.07.1.09a.26.26 0 0 0 .23 0 .3.3 0 0 0 .1-.07.26.26 0 0 0 .07-.2.32.32 0 0 0-.03-.11.88.88 0 0 0-.08-.13l-.5.23ZM4.34 6.93l.27.16-.01.02a.4.4 0 0 0-.1-.03.2.2 0 0 0-.1 0 .18.18 0 0 0-.06.04.36.36 0 0 0-.06.08l-.1.16.88.52.14.06c.04-.01.07-.04.1-.08l.02-.04.03.02-.29.48-.03-.01.03-.05c.03-.04.03-.09.01-.12 0-.03-.04-.06-.1-.1l-.89-.51-.08.13a.51.51 0 0 0-.04.1.18.18 0 0 0-.01.08c0 .03.01.06.03.08l.09.09-.02.03-.27-.16.56-.95Zm14.58.24-.32.21a.35.35 0 0 0-.11.11c-.01.04 0 .08.02.12l.03.05-.03.02-.32-.48.03-.02.03.04.05.06.06.01c.03 0 .07-.02.14-.06l.71-.48c.07-.05.1-.09.11-.11a.17.17 0 0 0-.02-.12l-.03-.04.03-.02.27.4c.07.1.11.18.13.26a.39.39 0 0 1 0 .2.32.32 0 0 1-.13.18.39.39 0 0 1-.15.07h-.14a.35.35 0 0 1-.13-.07.5.5 0 0 1-.12-.13 1.04 1.04 0 0 1-.1-.2ZM5.9 7.02l.03.03-.35.45-.03-.02.03-.04c.03-.04.04-.08.03-.12 0-.03-.04-.07-.1-.11l-.69-.53a1.06 1.06 0 0 0-.1-.07h-.03a.18.18 0 0 0-.1.07l-.04.03-.03-.02.35-.45.03.02-.03.04c-.04.04-.05.08-.04.12 0 .03.04.06.1.11l.7.53a1.09 1.09 0 0 0 .1.06h.03a.1.1 0 0 0 .04 0 .2.2 0 0 0 .07-.06l.03-.04Zm13.08.12.04.08a.5.5 0 0 0 .03.06l.08.07a.26.26 0 0 0 .2.03.37.37 0 0 0 .2-.14.26.26 0 0 0 .04-.21.3.3 0 0 0-.08-.15.64.64 0 0 0-.05-.05l-.46.3ZM5.52 5.47a.6.6 0 0 1 .47-.15c.18.01.34.1.47.24.13.15.2.32.19.5a.62.62 0 0 1-.22.47.61.61 0 0 1-.48.15.7.7 0 0 1-.47-.25.67.67 0 0 1-.18-.53.64.64 0 0 1 .22-.43Zm12.62-.16-.36.38.22.2.08.07.07.01c.02 0 .04 0 .06-.02a.48.48 0 0 0 .07-.06l.03.03-.32.34-.03-.03a.97.97 0 0 0 .07-.1v-.09A.21.21 0 0 0 18 6a.46.46 0 0 0-.05-.05l-.22-.2-.3.32a.39.39 0 0 0-.07.08v.04l.02.03.03.03.17.16a1.81 1.81 0 0 0 .13.1.2.2 0 0 0 .05.01h.16l.12-.04.03.03-.32.16-.75-.7.03-.03.03.03.03.03.04.02h.08l.1-.1.59-.63c.05-.06.08-.1.08-.13s-.01-.07-.05-.1l-.04-.04.03-.03.74.7-.2.22-.01-.02.04-.07a.3.3 0 0 0 .02-.06v-.1a.47.47 0 0 0-.1-.1l-.27-.25Zm-12.59.22a.37.37 0 0 0-.12.34c0 .06.03.13.07.2l.14.2a1.08 1.08 0 0 0 .39.28c.06.02.12.02.18 0a.35.35 0 0 0 .17-.08.42.42 0 0 0 .1-.14.34.34 0 0 0 .04-.17.54.54 0 0 0-.06-.2 1.22 1.22 0 0 0-.36-.42.62.62 0 0 0-.19-.1.38.38 0 0 0-.18 0 .4.4 0 0 0-.18.1Zm.63-.61.29-.22 1.25.32-.46-.62c-.05-.07-.09-.1-.11-.1-.04-.01-.08 0-.12.03l-.04.03-.02-.03.37-.28.02.03-.03.03c-.05.03-.07.07-.07.1s.02.08.07.14l.67.9-.03.02-1.34-.33.49.65c.05.07.09.1.11.11.04 0 .08 0 .12-.03l.04-.03.02.03-.37.27L7 5.92l.04-.03c.05-.04.07-.07.07-.12 0-.02-.03-.06-.07-.12l-.56-.75-.07-.01h-.09c-.02 0-.04 0-.06.02a.29.29 0 0 0-.07.04l-.02-.03Zm10.3-.93.3.2.11 1.3.44-.64c.05-.07.07-.11.06-.14 0-.04-.03-.07-.07-.1l-.04-.03.02-.03.39.27-.02.03-.04-.03c-.05-.03-.1-.04-.13-.03a.37.37 0 0 0-.1.11l-.64.93-.03-.02-.11-1.39-.47.68c-.04.07-.07.12-.06.14 0 .04.03.07.07.1l.04.03-.02.03-.39-.26.03-.03.03.02c.05.04.1.04.13.03.03-.01.06-.04.1-.1l.53-.77a1.26 1.26 0 0 0-.02-.12.18.18 0 0 0-.02-.04l-.04-.05a.3.3 0 0 0-.06-.06l.02-.03Zm-.77 1.07-.02.03-.5-.26.01-.04.04.03c.05.02.1.03.13 0 .02 0 .06-.04.1-.11l.4-.77a.85.85 0 0 0 .04-.11v-.04l-.01-.03a.18.18 0 0 0-.07-.06l-.04-.02.01-.03.5.26v.03l-.05-.02c-.05-.03-.1-.03-.13-.01-.02 0-.05.05-.1.12l-.4.76-.02.07-.02.05v.03l.02.04.06.06.05.02ZM8.65 4.9l-.01-.03.04-.02c.06-.02.09-.05.1-.1l-.04-.14-.31-.8c-.03-.08-.06-.12-.08-.13-.04-.02-.08-.02-.13 0l-.04.02-.02-.04.5-.2c.2-.07.34-.1.46-.1.11 0 .22.05.31.12.1.08.18.18.23.3.03.1.05.19.05.28a.6.6 0 0 1-.22.46.96.96 0 0 1-.28.17l-.56.21Zm6.79-1.4-.13.41-.03-.01c0-.11 0-.2-.04-.27A.42.42 0 0 0 15 3.4a.44.44 0 0 0-.43.04.72.72 0 0 0-.26.33.81.81 0 0 0-.06.35.62.62 0 0 0 .08.27.46.46 0 0 0 .35.21h.14l.15-.35a.59.59 0 0 0 .02-.08l.01-.05v-.04l-.02-.02a.27.27 0 0 0-.1-.06l.01-.04.48.2-.01.03h-.03a.19.19 0 0 0-.05-.02l-.05.01a.15.15 0 0 0-.04.05.76.76 0 0 0-.05.09L15 4.7a1.14 1.14 0 0 1-.24 0 .96.96 0 0 1-.24-.07c-.24-.1-.39-.25-.45-.45a.66.66 0 0 1 .09-.58.83.83 0 0 1 .2-.2.65.65 0 0 1 .11-.07.61.61 0 0 1 .27-.06.73.73 0 0 1 .47.17l.06.06a.3.3 0 0 0 .06.05h.04l.04-.06h.03ZM8.97 4.69a.95.95 0 0 0 .2-.05.53.53 0 0 0 .19-.12c.05-.05.08-.1.1-.17a.56.56 0 0 0 .04-.22.73.73 0 0 0-.05-.24.73.73 0 0 0-.13-.22.54.54 0 0 0-.17-.13.53.53 0 0 0-.42 0 .66.66 0 0 0-.18.09l.42 1.06Zm4.79-.37v.04l-.57-.08v-.04h.05c.06.01.1 0 .13-.02.02-.02.03-.07.04-.15l.12-.85a3.33 3.33 0 0 0 .01-.13v-.03l-.03-.03a.19.19 0 0 0-.09-.03l-.05-.01v-.04l.57.09v.03h-.05c-.05-.01-.1 0-.12.03-.02.01-.04.06-.05.14l-.12.86a2.79 2.79 0 0 0-.01.12l.01.03.03.03a.2.2 0 0 0 .08.03l.05.01Zm-2.83-1.46a.6.6 0 0 1 .46.16c.14.12.21.28.23.48a.7.7 0 0 1-.15.51.62.62 0 0 1-.45.24.61.61 0 0 1-.48-.16.7.7 0 0 1-.22-.5.67.67 0 0 1 .17-.52c.12-.13.26-.2.44-.21Zm2.21 1.38-.35-.01-.43-.64h-.11a.3.3 0 0 1-.03-.01l-.02.39c0 .08 0 .13.03.15.02.03.06.05.1.05h.06v.04l-.57-.02v-.04h.05c.05 0 .1-.01.12-.05.02-.02.02-.06.03-.14l.03-.86c0-.09 0-.14-.02-.16-.02-.03-.06-.04-.11-.05h-.05v-.03l.48.01c.14 0 .25.02.32.05a.34.34 0 0 1 .21.21.32.32 0 0 1-.07.32.36.36 0 0 1-.1.07.6.6 0 0 1-.16.05l.26.39c.06.1.12.15.16.18.04.03.1.05.17.06v.04Zm-2.23-1.31a.36.36 0 0 0-.3.19.6.6 0 0 0-.06.2c-.01.08-.02.16-.01.26 0 .1.02.18.05.25.02.08.05.14.1.2a.35.35 0 0 0 .33.15c.05 0 .1-.02.16-.05.05-.03.1-.07.13-.12a.54.54 0 0 0 .07-.2c.02-.07.02-.16.02-.27l-.05-.27a.61.61 0 0 0-.1-.2.37.37 0 0 0-.14-.11.39.39 0 0 0-.2-.03Zm-.98.73-.12-.28-.04-.1a.4.4 0 0 1-.02-.05v-.1a.1.1 0 0 1 .06-.04.1.1 0 0 1 .08.01.1.1 0 0 1 .05.07 1 1 0 0 1 .01.18l.02.3h-.04Zm2.3-.14h.05l.17-.01a.37.37 0 0 0 .12-.06.26.26 0 0 0 .1-.2.3.3 0 0 0-.01-.12.26.26 0 0 0-.15-.15.3.3 0 0 0-.11-.03h-.07l-.09.01-.02.56Z"/>
    <path fill="#ffde2d" d="m11.95 17.07.18.56h.59l-.48.35.18.56-.47-.35-.48.35.19-.56-.48-.35h.59l.18-.55Zm2.93-1.03.18.56h.59l-.48.35.19.56-.48-.35-.48.35.19-.56-.48-.35h.59l.18-.56Zm-5.87 0 .18.56h.59l-.48.35.18.56-.47-.35-.48.35.18-.56-.47-.35h.59l.18-.56Zm-1.1-2.67.22.64c1.57.44 3.2.75 4.39 2.3l.61-.14c-.99-1.6-2.94-2.42-5.22-2.8Zm.58 1.2s.88.22 1.55.66c.68.43.89.99.89.99a4.2 4.2 0 0 1-2.44-1.64Zm-.75-1.73-.07-.6c2.84.33 5.23 1.33 7.16 3.05l-.48.37a12.63 12.63 0 0 0-6.61-2.82Zm-.61 1.25.18.56h.59l-.48.34.18.56-.47-.34-.48.34.18-.56-.47-.34h.59l.18-.56Zm9.64-.04.19.56h.58l-.47.34.18.56-.48-.35-.47.35.18-.56-.47-.34h.58l.18-.56Zm-6.05-2.3c1.46-.56 3.24-.9 5.4-1l.08.44a14.7 14.7 0 0 0-4.77.77l.62.22a12.3 12.3 0 0 1 4.25-.47v.44a11.69 11.69 0 0 0-3.54.3l.68.3a7.97 7.97 0 0 1 2.76 0l-.1.48a5.46 5.46 0 0 0-1.98-.15c.58.29 1.14.6 1.68.95l-.3.5a19.6 19.6 0 0 0-7.83-2.82l.07-.57c1.03.13 2.02.34 2.98.6Zm-4.5-.48.17.56H7l-.48.34.18.56-.48-.34-.47.34.18-.56-.48-.34h.59l.18-.56Zm11.5 0 .19.56h.59l-.48.34.18.56-.47-.34-.48.34.18-.56-.47-.34h.58l.19-.56ZM7 8.27l.19.56h.58l-.47.34.18.56L7 9.4l-.47.34.18-.56-.47-.34h.58L7 8.27Zm9.93-.01.18.56h.59l-.48.34.19.56-.48-.35-.48.35.18-.56-.47-.34h.59l.18-.56Zm-7.8-1.98.17.56h.59l-.47.34.18.56-.48-.34-.47.34.18-.56-.48-.34h.59l.18-.56Zm5.67 0 .18.56h.59l-.48.34.19.56-.48-.34-.47.34.18-.56-.48-.34h.59l.18-.56Zm-2.86-.82.18.56h.59l-.48.35.19.56-.48-.35-.47.35.18-.56-.48-.35h.59l.18-.56Z"/>
    
  </svg>
)

export const VegIcon = () => <div className="icon veg"><VegSvg /></div>;
export const VgnIcon = () => <div className="icon vgn"><VegSvg /><b>vegan</b></div>;
export const BioIcon = () => <div className="icon bio"><BioSvg /></div>;
export const AocIcon = () => <div className="icon aoc"><AocSvg /></div>;
export const AopIcon = () => <div className="icon aop"><AopSvg /></div>;

renderAdd('product', ({ b, a }) => (
  <div {...a}>
    <div className="row">
      <RenderContent t="h4" b={b} p="title" />
      <RenderContent b={b} p="info" />
      <RenderCl b={b} p="cl" />
      {b.n.vgn && <VgnIcon />}
      {b.n.veg && <VegIcon />}
      {b.n.bio && <BioIcon />}
      {b.n.aoc && <AocIcon />}
      {b.n.aop && <AopIcon />}
      <div className="flex"></div>
      <RenderContent b={b} p="info2" />
      <RenderPrice b={b} p="price" />
      <RenderPrice b={b} p="price2" />
      <RenderPrice b={b} p="price3" />
    </div>
    <RenderContent b={b} p="desc" />
    {renderChildren(b)}
  </div>
));

renderAdd('price', ({ b, a }) => (
  <RenderPrice b={b} p="price" />
));

renderAdd('carousel', ({ b, a }) => {
  // console.debug('carousel render');
  const [count, setCount] = useState(0);
  const childIds = b.n.childIds || [];
  const length = childIds.length;

  useInterval(() => setCount((count) => count + 1), (b.n.duration || 10000) / length);

  if (count % length === 0) renderActions(b, 'onStart', b.n.onStart);
  if (count % length === length - 1) renderActions(b, 'onEnd', b.n.onEnd);

  const children = childIds.map((id, index) => {
    const classes: NClasses = {};
    if (index === (count - 1) % length) classes.last = 1;
    if (index === (count + 1) % length) classes.next = 1;
    if (index === count % length) classes.curr = 1;
    return <RenderFactory key={id} id={id} classes={classes} />;
  });

  return <div {...a}>{children}</div>;
});

renderAdd('lang', ({ b, a }) => {
  const curr = useMessager(lang$);
  const lang = b.n.lang || 'fr';
  return (
    <div
      {...a}
      className={curr === lang ? a.className + ' lang-active' : a.className}
      style={{
        backgroundImage: `url(https://${app.host}/files/flags/${lang}.svg?t)`,
        ...a.style,
      }}
      onClick={(e) => {
        setLang(lang);
        if (a.onClick) a.onClick(e);
      }}
    >
      {renderChildren(b)}
    </div>
  );
});